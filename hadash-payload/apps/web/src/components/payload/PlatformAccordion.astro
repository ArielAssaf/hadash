---
const { block, lang } = Astro.props;
const isRtl = lang === 'he';
---

<div class="py-12 md:py-20 bg-background-light dark:bg-background-dark font-display text-neutral-dark dark:text-white antialiased">
    <div class="max-w-[1000px] mx-auto px-4 md:px-6 lg:px-8 flex flex-col gap-12">
        <!-- Header -->
        <div class="flex flex-col lg:flex-row lg:items-end justify-between gap-6 pb-6 border-b border-[#f3e8e8] dark:border-gray-800">
            <div class="flex flex-col gap-3 max-w-2xl">
                <div class="flex items-center gap-2 text-primary font-bold uppercase tracking-wider text-xs">
                    <span class="material-symbols-outlined text-base">campaign</span>
                    <span>{block.title}</span>
                </div>
                <h1 class="text-4xl md:text-5xl font-black tracking-tight leading-[1.1]">{block.title}</h1>
                <p class="text-neutral-muted dark:text-gray-400 text-lg md:text-xl font-normal leading-relaxed max-w-xl">
                    {block.description}
                </p>
            </div>
            {block.manifestoLink && (
                <div class="flex gap-3">
                    <a href={block.manifestoLink}
                        class="flex items-center justify-center gap-2 bg-neutral-dark dark:bg-white text-white dark:text-neutral-dark px-6 py-3 rounded-lg font-bold text-sm hover:opacity-90 transition-opacity shadow-lg">
                        <span class="material-symbols-outlined">download</span>
                        <span>{block.manifestoLabel || 'Full PDF Manifesto'}</span>
                    </a>
                </div>
            )}
        </div>

        <!-- Accordion Sections -->
        <div class="flex flex-col gap-4">
            {block.sections?.map((section: any, index: number) => (
                <details
                    class="group bg-white dark:bg-[#1a0e0e] rounded-xl border border-gray-200 dark:border-gray-800 shadow-xl overflow-hidden"
                    open={index === 0}>
                    <summary
                        class="flex items-center justify-between p-6 cursor-pointer hover:bg-gray-50 dark:hover:bg-[#2a1a1b] transition-colors select-none">
                        <div class="flex items-center gap-4">
                            <div
                                class="size-10 rounded-lg bg-red-100 dark:bg-red-900/30 text-primary flex items-center justify-center">
                                <span class="material-symbols-outlined text-2xl">{section.icon || 'handshake'}</span>
                            </div>
                            <h3 class="text-xl font-black text-neutral-dark dark:text-white">{section.title}</h3>
                        </div>
                        <span
                            class="material-symbols-outlined text-gray-400 group-hover:text-primary transition-colors chevron transform transition-transform duration-200">expand_more</span>
                    </summary>
                    <div
                        class="px-6 pb-6 pt-2 text-neutral-dark dark:text-gray-300 leading-relaxed border-t border-gray-100 dark:border-gray-800">
                        <div class="mb-4 whitespace-pre-wrap">
                            {section.content}
                        </div>
                        {section.bulletPoints && section.bulletPoints.length > 0 && (
                            <ul class="list-disc pl-5 rtl:pr-5 rtl:pl-0 space-y-2 text-neutral-muted dark:text-gray-400">
                                {section.bulletPoints.map((point: any) => (
                                    <li>{point.text}</li>
                                ))}
                            </ul>
                        )}
                    </div>
                </details>
            ))}
        </div>

        <!-- CTA Section -->
        {(block.ctaTitle || block.ctaDescription) && (
            <div class="mt-8 rounded-xl bg-neutral-dark dark:bg-neutral-800 overflow-hidden relative isolate">
                <div class="absolute inset-0 -z-10 opacity-20" 
                    style="background-image: radial-gradient(#e31c23 1px, transparent 1px); background-size: 20px 20px;">
                </div>
                <div
                    class="px-6 py-12 md:px-12 md:py-16 text-center md:text-left rtl:md:text-right flex flex-col md:flex-row items-center justify-between gap-8">
                    <div class="max-w-xl">
                        <h2 class="text-3xl font-black text-white tracking-tight mb-4">{block.ctaTitle}</h2>
                        <p class="text-gray-300 text-lg">{block.ctaDescription}</p>
                    </div>
                    <div class="flex flex-col sm:flex-row gap-4 w-full md:w-auto">
                        {block.ctaButton1Text && (
                            <a href={block.ctaButton1Link || '#'}
                                class="bg-primary hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:shadow-xl transition-all text-center whitespace-nowrap w-full sm:w-auto">
                                {block.ctaButton1Text}
                            </a>
                        )}
                        {block.ctaButton2Text && (
                            <a href={block.ctaButton2Link || '#'}
                                class="bg-transparent border-2 border-white hover:bg-white hover:text-neutral-dark text-white font-bold py-3 px-6 rounded-lg transition-all text-center whitespace-nowrap w-full sm:w-auto">
                                {block.ctaButton2Text}
                            </a>
                        )}
                    </div>
                </div>
            </div>
        )}
    </div>
</div>

<style>
    details > summary {
        list-style: none;
    }

    details > summary::-webkit-details-marker {
        display: none;
    }

    details[open] summary ~ * {
        animation: sweep .3s ease-in-out;
    }

    @keyframes sweep {
        0% {
            opacity: 0;
            transform: translateY(-10px)
        }

        100% {
            opacity: 1;
            transform: translateY(0)
        }
    }

    details[open] summary .chevron {
        transform: rotate(180deg);
    }
</style>
